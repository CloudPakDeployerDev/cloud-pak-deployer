# Uninstall Cloud Pak for Data and Foundational Services

## Check all CRs in cluster
```
for crd in $(oc get crd --no-headers | grep ibm | awk '{print $1}');do 
    cr=$(oc get crd $crd -o=jsonpath='{.spec.names.kind}')
    echo $cr;oc get $cr -A
done
```

## Remove all cartridge CRs
```
oc delete wkc --all
oc delete ws --all
oc delete wmlbase --all
oc delete ccs --all
...
```

If you want to, you can hit Ctrl-C when deleting the CCS object, the deletion continues to be carried out in the background by the operator. 

## Remove Cloud Pak for Data CR

** IMPORTANT: You must now wait until all CRs have been deleted from the namespace before deleting the Ibmcpd CR.**
```
oc delete ibmcpd --all
```

Repeat the command to check all CRs in the cluster and wait until all objects in the Cloud Pak for Data namespace have been deleted.

## Delete CP4D namespace
Now you can delete the CP4D namespace. This can take a few minutes.

## Remove Foundational Services

### Remove CommonService operator
```
oc delete CommonService -n ibm-common-services common-service
oc delete sub -n ibm-common-services -l operators.coreos.com/ibm-common-service-operator.ibm-common-services
oc delete csv -n ibm-common-services -l operators.coreos.com/ibm-common-service-operator.ibm-common-services

oc delete operandrequest -n ibm-common-services --all

oc delete operandconfig -n ibm-common-services --all

oc delete operandregistry --all

oc delete nss -n ibm-common-services --all

oc delete sub -n ibm-common-services --all
oc delete csv -n ibm-common-services --all

oc delete ns ibm-common-services

oc delete catsrc -n openshift-marketplace $(oc get catsrc -n openshift-marketplace --no-headers | grep -i ibm | awk '{print $1}')
```

### Clean up left-over objects
Most of the below commands will issue an error because the object no longer exists.
```
oc -n kube-system delete secret icp-metering-api-secret 
oc -n kube-public delete configmap ibmcloud-cluster-info
oc -n kube-public delete secret ibmcloud-cluster-ca-cert
oc delete ValidatingWebhookConfiguration cert-manager-webhook ibm-cs-ns-mapping-webhook-configuration --ignore-not-found
oc delete MutatingWebhookConfiguration cert-manager-webhook ibm-common-service-webhook-configuration ibm-operandrequest-webhook-configuration namespace-admission-config --ignore-not-found
oc delete namespace services
oc delete nss --all
```
