---
title: OpenShift configuration
tabs: ['Objects', 'Vault', 'Infrastructure', 'OpenShift', 'Cloud Paks', 'Cartridges', 'Configuration', 'Other']
---

# OpenShift configuration

### `openshift`
For OpenShift, there are 2 flavours:
* OpenShift on IBM Cloud (within VPC)
* Existing OpenShift

When running the Cloud Pak Deployer for IBM Cloud, the ROKS cluster will be provisioned and managed by Terraform. For existing OpenShift clusters, other parameters must be specified to identify the cluster on which the Cloud Pak(s) must be deployed. Below we will show 2 examples.

### OpenShift on IBM Cloud (ROKS)
```
openshift:
- name: sample
  ocp_version: 4.6
  worker_flavour: bx2.16x64
  number_of_workers: 2
  max_number_of_workers: 10
  resource_group_name: ibm
  infrastructure:
    type: vpc
    vpc_name: sample
    subnets: 
    - sample-subnet-zone-1
    - sample-subnet-zone-2
    - sample-subnet-zone-3
  openshift_storage:
  - storage_name: nfs-storage
    storage_type: nfs
    nfs_server_name: sample-nfs
  - storage_type: ocs
    ocs_storage_label: ocs
    ocs_storage_size: 500Gi
```

#### Property explanation OpenShift clusters on IBM Cloud (ROKS)
| Property | Description                                                          | Mandatory | Allowed values |
| -------- | -------------------------------------------------------------------- | --------- | -------------- |
| name     | Name of the OpenShift cluster                                        | Yes       |  |
| ocp_version | ROKS Kubernetes version                                           | Yes       | 4.6 |
| worker_flavour | Type of worker to be used                                      | Yes       | [link]  |
| number_of_workers | Total number of workers. This must be a factor of the number of subnets | Yes | Integer |
| max_number_of_workers | Maximum number of workers allowed. If total number of workers exceeds this value, the cluster will not be provisioned | Yes | Integer |
| resource_group_name | IBM Cloud resource group for the ROKS cluster             | Yes, inferred  |  |
| infrastructure.type | Type of infrastructure to provision ROKS cluster on | No | vpc (default), classic |
| infrastructure.vpc_name | Name of the VPC if type is `vpc` | Yes, inferrred | Existing VPC |
| infrastructure.subnets | List of subnets within the VPC to use. Either 1 or 3 subnets must be specified | Yes | Existing subnet |
| openshift_storage.storage_type | Type of storage class to create in the OpenShift cluster | Yes | nfs or ocs |
| openshift_storage.nfs_server_name | Name of the NFS server within the VPC | Yes if `storage_type` is `nfs` | Existing `nfs_server` |
| openshift_storage.ocs_storage_label | Label to be used for the dedicated OCS nodes in the cluster | Yes if `storage_type` is `ocs` |  |
| openshift_storage.ocs_storage_size | Size of the OCS storage in Gibibytes (Gi) | Yes if `storage_type` is `ocs` |  |


### Existing OpenShift
When using the Cloud Pak Deployer on an existing OpenShift cluster, the scripts assume that the cluster is already operational and that any storage classes have been pre-created. The deployer accesses the cluster through a vault secret with the kubeconfig information; the name of the secret is `<name>-kubeconfig`.
```
openshift:
- name: sample
  ocp_version: 4.6
  cluster_name: sample
  domain_name: example.com
  openshift_storage:
  - storage_name: nfs-storage
    storage_type: nfs
    # ocp_storage_class_file: nfs-client 
    # ocp_storage_class_block: nfs-client
```

#### Property explanation for existing OpenShift clusters
| Property | Description                                                          | Mandatory | Allowed values |
| -------- | -------------------------------------------------------------------- | --------- | -------------- |
| name     | Name of the OpenShift cluster                                        | Yes       |  |
| ocp_version | OpenShift version of the cluster (not used for now)               | No        | 4.6 |
| cluster_name | Name of the cluster (part of the FQDN)                           | Yes | |
| domain_name | Domain name of the cluster (part of the FQDN)                     | Yes | |
| openshift_storage.name | Name of the storage definition, to be referenced by the Cloud Pak | Yes |  |
| storage_classes.storage_type | Type of storage class to use in the OpenShift cluster | Yes | nfs, ocs |
| openshift_storage.ocp_storage_class_file | OpenShift storage class to use for file storage, defaults to `managed-nfs-storage` | No | |
| openshift_storage.ocp_storage_class_block | OpenShift storage class to use for block storage, defaults to `managed-nfs-storage` | No | |

