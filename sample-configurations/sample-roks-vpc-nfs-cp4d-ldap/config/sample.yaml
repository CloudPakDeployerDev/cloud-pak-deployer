---
provider:
- name: ibm
  region: eu-de

resource_group:
- name: "ibm" # should exist already

ssh_keys:
- name: sample-provision
  managed: True 

security_rule:
- name: https
  tcp: {port_min: 443, port_max: 443}
- name: ssh
  tcp: {port_min: 22, port_max: 22}

vpc:
- name: sample
  allow_inbound: ['ssh']

address_prefix:
### Prefixes for the client environment
- name: sample-zone-1
  vpc: sample
  zone: eu-de-1
  cidr: 10.231.0.0/26
- name: sample-zone-2
  vpc: sample
  zone: eu-de-2
  cidr: 10.231.0.64/26
- name: sample-zone-3
  vpc: sample
  zone: eu-de-3
  cidr: 10.231.0.128/25 

subnet:
  ### subnets for the client vpc ###
- name: sample-subnet-zone-1
  vpc: sample # TODO: resolve this via the prefix
  address_prefix: sample-zone-1
  ipv4_cidr_block: 10.231.0.0/26
  zone: eu-de-1 # TODO: resolve this via the prefix
- name: sample-subnet-zone-2
  vpc: sample # TODO: resolve this via the prefix
  address_prefix: sample-zone-2
  ipv4_cidr_block: 10.231.0.64/26
  zone: eu-de-2 # TODO: resolve this via the prefix
- name: sample-subnet-zone-3
  vpc: sample # TODO: resolve this via the prefix
  address_prefix: sample-zone-3
  ipv4_cidr_block: 10.231.0.128/26
  zone: eu-de-3 # TODO: resolve this via the prefix
- name: sample-subnet-zone-shared
  vpc: sample # TODO: resolve this via the prefix
  address_prefix: sample-zone-3
  ipv4_cidr_block: 10.231.0.192/26
  zone: eu-de-3 # TODO: resolve this via the prefix

vsi:
- name: sample-bastion
  infrastructure:
    vpc_name: sample
    zone: eu-de-3
    subnet: sample-subnet-zone-shared
    primary_ipv4_address: 10.231.0.196
    public_ip: True
    keys:
    - "sample-provision"

nfs_server:
- name: sample-nfs
  infrastructure:
    type: vpc
    subnet: sample-subnet-zone-shared
    primary_ipv4_address: 10.231.0.197
    zone: eu-de-3 # TODO: resolve this via the subnet->prefix
    vpc_name: sample # TODO: resolve this via the subnet->prefix
    bastion_host: sample-bastion
    volume_selector: 1000G
    mount_path: /data
    storage_folder: /data/nfs    
    keys:
    - "sample-provision"
  storage:
  - name: sample-nfs-data
    profile: 10iops-tier
    size: 1000

roks:
- name: sample
  kube_version: 4.6_openshift # Mandatory
  worker_flavour: bx2.16x64
  worker_count: 1
  resource_group_name: ibm
  max_worker_count: 10 # Optional, default is no maximum
  infrastructure:
    type: vpc # TODO no other options yet
    vpc_name: sample # Mandatory if type==vpc
    subnets: 
    - sample-subnet-zone-1
    - sample-subnet-zone-2
    - sample-subnet-zone-3
  storage_classes:
  - storage_type: nfs
    nfs_server_name: sample-nfs
  # - storage_type: ocs
  #   ocs_storage_label: ocs
  #   ocs_storage_size: 500Gi

cp4d:
# Example Cloud Pak for Data 3.5 instance, using a private registry on IBM Cloud
- project: zen-35
  openshift_cluster_name: sample
  container_registry_namespace: cpd-sample
  cartridges:
  - name: lite
    version: 3.5.0.0          
    size: medium
  - name: wsl
    version: 3.5.0.0
    size: medium

# Example Cloud Pak for Data 4.0 instance, using the entitled registry
- project: zen-40
  openshift_cluster_name: sample
  cp4d_version: 4.0
  cartridges:
  - name: lite
    version: 4.0.1
    subscription_channel: stable-v1
    size: medium
  - name: wsl
    version: 2.0.0
    subscription_channel: v2.0
    size: small
  - name: wml
    version: 4.0.0
    subscription_channel: alpha
    size: small
  - name: wkc
    version: 4.0.0
    subscription_channel: v1.0
    size: small

# Other cartridges - tested
  # - name: ca
  #   version: 4.0.0
  #   subscription_channel: v4.0
  #   size: small
  #   metastore_ref: db2-ca-meta

# Other cartridges - not tested yet
  # - name: bigsql
  #   version: 4.0.0
  #   subscription_channel: v7.2
  #   size: small
  # - name: cde
  #   version: 
  #   subscription_channel: v1.0
  #   size: small
  # - name: datarefinery
  #   version: 
  #   subscription_channel: v1.0
  #   size: small
  # - name: dv
  #   version: 
  #   subscription_channel: v1.0
  #   size: small
  # - name: db2
  #   version: 
  #   subscription_channel: v1.0
  #   db2u_subscription_channel: v1.1
  #   size: small

