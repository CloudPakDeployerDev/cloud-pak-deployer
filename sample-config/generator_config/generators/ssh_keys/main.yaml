---
- name: "Start {{generator.name}} generator"
  debug:
    msg: 'from {{generator.name}} in {{generator.path}} attributes: {{generator.attributes}}'


# list/map the keys

- name: 'generate instance of "{{generator.name}}" in {{path_to_terraform_folder}}/{{generator.name}}_{{generator.attributes.name}}.tf'
  template:
    src: '../templates/main.tf.j2'
    dest: '{{ path_to_terraform_folder }}/{{generator.name}}_{{generator.attributes.name}}.tf'
  vars:
    sshkey_value: "{{ lookup('vars', generator.attributes.name + '-ssh-pub-key' | replace('-', '_') ) }}"