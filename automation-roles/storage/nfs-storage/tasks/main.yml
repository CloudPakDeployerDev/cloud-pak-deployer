---

- name: Validate mandatory variables are defined
  assert:
    that:
      - cloud_platform is defined

- name: Validate cloud_platform is implemented
  fail: msg="cloud_platform {{ cloud_platform }} is not implemented, current implemented cloud platforms are {{ implemented_cloud_platform_types }} "
  when: "cloud_platform not in implemented_cloud_platform_types"


- set_fact:
    storage_type: "{{ roks_config.roks[0].storage_classes[0].storage }}

# - name: NFS Storage for IBM Cloud
#   block:
#     - name: Configure NFS Storage for IBM Cloud
#       include_role: 
#         name: nfs-storage-ibmcloud
    
#   when: "cloud_platform == 'ibm-cloud'"

- name: NFS Server for IBM Cloud
  block:
    - name: Configure NFS Server for IBM Cloud
      include_role: 
        name: nfs-server-ibmcloud
  when: "cloud_platform == 'ibm-cloud' and storage_type == 'nfs'"

