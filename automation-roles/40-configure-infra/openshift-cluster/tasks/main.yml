---
- name: Show OpenShift cluster that is being processed
  debug:
    msg: "Handling OpenShift cluster {{ current_openshift_cluster.name }}"

- name: Download and activate OpenShift client for version {{ current_openshift_cluster.ocp_version }}
  include_role:
    name: openshift-download-client
  vars:
    _p_ocp_version: "{{ current_openshift_cluster.ocp_version }}"

- name: Login to the OpenShift cluster {{ current_openshift_cluster.name }}
  include_role:
    name: openshift-login
  vars:
    openshift_cluster_name: "{{ current_openshift_cluster.name }}"

- name: Prepare storage for OpenShift cluster {{ current_openshift_cluster.name }}
  include_role:
    name: prepare-openshift-storage
  loop: "{{ current_openshift_cluster.openshift_storage | default([]) }}"
  loop_control:
    loop_var: current_openshift_storage
