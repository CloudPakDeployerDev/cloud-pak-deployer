---
- name: CPD TEST CARTRIDGES installation of cartridge {{ current_cp4d_cartridge.name }}
  block:
    - name: CPD TEST CARTRIDGES - Show cartridges to be installed
      debug:
        var: current_cp4d_cluster.cartridges

    - name: CPD TEST CARTRIDGES - Delete obsolete cartridges
      include_role:
        name: cp4d-cartridge-remove

    - name: CPD TEST CARTRIDGES - Install selected cartridges for the cluster
      include_role:
        name: cp4d-cartridge-install
  loop: "{{ current_cp4d_cluster.cartridges | default([]) }}"
  loop_control:
    loop_var: current_cp4d_cartridge

