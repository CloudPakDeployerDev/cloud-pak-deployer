- debug:
    msg: "Installing cartridges for CP4D cluster {{ current_cp4d_cluster.project }}"

- name: Prepare OpenShift operator subscriptions for each of the selected cp4d cartridges
  include_tasks: cp4d-create-subscriptions.yml
  loop: "{{ current_cp4d_cluster.cartridges | default([]) }}"
  loop_control:
    loop_var: current_cp4d_cartridge

- name: Install custom resource (CR) for each of the selected cp4d cartridges
  include_tasks: cp4d-install-cr.yml
  loop: "{{ current_cp4d_cluster.cartridges | default([]) }}"
  loop_control:
    loop_var: current_cp4d_cartridge

- name: Wait for cartridges to finish installation
  include_tasks: cp4d-wait-cartridges-ready.yml
