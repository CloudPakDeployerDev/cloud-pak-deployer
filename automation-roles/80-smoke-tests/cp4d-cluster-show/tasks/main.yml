---

- set_fact:
    _current_openshift_cluster: "{{ all_config.openshift | json_query(query) | first | default({}) }}"
  vars:
    query: >-
      [?name=='{{ current_cp4d_cluster.openshift_cluster_name }}']

- name: Download and activate OpenShift client for version {{ _current_openshift_cluster.ocp_version }}
  include_role:
    name: openshift-download-client
  vars:
    _p_ocp_version: _current_openshift_cluster.ocp_version

- name: Login to the OpenShift cluster
  include_role:
    name: openshift-login
  vars:
    openshift_cluster_name: "{{ current_cp4d_cluster.openshift_cluster_name }}"

- name: Output Cloud pak for Data URL and admin password
  include_tasks: cp4d-show-details.yml