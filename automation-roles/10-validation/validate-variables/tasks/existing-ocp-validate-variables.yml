---
- name: Check if kubeconfig secret is in the vault
  include_role: 
    name: vault-get-secret
  vars:
    secret_name: "kubeconfig"
    secret_group: "{{ environment_name }}" 

- name: Check that kubeconfig secret is present in the vault
  fail:
    msg: "Secret kubeconfig is mandatory and was not found in the vault"
  when: secret_value==""