---
- debug:
    msg: "{{ _scale_ds_runtime }}"

- debug:
    msg: "{{ _scale_ds_runtime_type }}"

- set_fact:
    _ds_px_replicas: "{{ _scale_ds_runtime.replicas | default(omit) | int }}"
    _ds_px_limit_cpu: "{{ _scale_ds_runtime.cpu_limit | default(omit) }}"
    _ds_px_limit_memory: "{{ _scale_ds_runtime.memory_limit | default(omit) }}"
    _ds_px_request_cpu: "{{ _scale_ds_runtime.cpu_request | default(omit) }}"
    _ds_px_request_memory: "{{ _scale_ds_runtime.memory_request | default(omit) }}"

- assert:
    that:
      - _ds_px_replicas is defined
      - _ds_px_limit_cpu is defined
      - _ds_px_limit_memory is defined
      - _ds_px_request_cpu is defined
      - _ds_px_request_memory is defined
    fail_msg: "Missing properties. In order to custom scale {{ _scale_ds_runtime_type }} of PXRuntime {{ _ds_instance_name }}, \
               ensure the properties 'replicas', 'cpu_limit', 'memory_limit', 'cpu_request' and 'memory_request' are specified."

- name: Create Custom Scale template for {{ _scale_ds_runtime_type }} of PXRuntime {{ _ds_instance_name }}
  template:
    src: "ds_patch_pxruntime.yml.j2"
    dest: "{{ status_dir }}/cp4d/{{ _ds_instance_name }}-pxruntime.yml"
    


- debug:
    msg: "{{ _custom_config_px_runtime }}"



