---
- name: Validate mandatory variables are defined
  assert:
    that:
      - all_config is defined


- name: Validate cloud_platform is supported is supported
  fail: msg="cloud_platform {{ cloud_platform }} only support values {{ supported_cloud_platform_types }} "
  when: "cloud_platform not in supported_cloud_platform_types"

- name: Loop through each cp4d entry
  include_role:
    name: ibmcloud-roks-configuration
  loop: "{{ all_config.roks }}"
  loop_control:
    loop_var: current_roks_cluster

- debug:
    msg: "{{ all_config }}"